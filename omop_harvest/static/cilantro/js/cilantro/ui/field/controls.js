define(["underscore","marionette","loglevel","../../core","../base","../controls"],function(e,t,i,n,o,s){var r=function(e,t){t&&(t.listenTo(e,"change",function(e,i){t.clear(),t.set(i)}),e.listenTo(t,"change",function(t){e._changing||e.set(t.toJSON())}))},a=function(e,t){t.stopListening(e),e.stopListening(t)},l=o.ErrorView.extend({message:"Error rendering field control"}),c=o.LoadView.extend({message:"Loading and rendering field controls..."}),u=t.ItemView.extend({errorView:l,template:function(){},initialize:function(){var t=this.model.get("control");if(t=s.get(t)||t,e.isFunction(t))this.viewClass=t;else{var n=this;require([t],function(e){n.viewClass=e,n.render()},function(e){n.showErrorView(),i.debug(e)})}},onRender:function(){this.viewClass&&(this.view=new this.viewClass(this.model.toJSON()),this.view.render(),this.$el.html(this.view.el),this.listenTo(this.view,{beforeready:this.onControlBeforeReady,error:this.onControlError}),this.view.ready(!0))},onBeforeClose:function(){if(this.view){var e=this.model.get("filter");a(this.view,e),this.view.close()}},onControlBeforeReady:function(){var e=this.model.get("filter");this.view.set(e.toJSON()),r(this.view,e)},onControlError:function(){this.showErrorView()},showErrorView:function(){this.view=new this.errorView(this.model.toJSON()),this.view.render(),this.$el.html(this.view.el)}}),h=t.CollectionView.extend({itemView:u,emptyView:c});return{FieldControls:h}});
//@ sourceMappingURL=controls.js.map